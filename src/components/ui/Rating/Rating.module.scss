@use '@/styles/variables.scss' as *;
@use '@/styles/mixins.scss' as *;

.rating {
  @include flex-center;
  gap: var(--rating-gap);
  user-select: none;
  outline: none;

  // Размеры рейтинга
  &--small {
    gap: calc(var(--rating-gap) * 0.75); // 6px для маленького размера

    .rating__star {
      width: var(--rating-size-sm);
      height: var(--rating-size-sm);
    }
  }

  &--large {
    .rating__star {
      width: var(--rating-size-lg);
      height: var(--rating-size-lg);
    }
  }

  // Состояния
  &--disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  &--readonly {
    cursor: default;

    .rating__star {
      cursor: default;

      &:hover {
        transform: none;
      }
    }
  }

  &--animating {
    .rating__star--active {
      animation: starSelected 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }
  }
}

.rating__star {
  @include reset-button;
  @include flex-center;
  padding: 0;
  background: transparent;
  border: none;
  cursor: pointer;
  transition: transform var(--transition-base);
  position: relative;

  animation: starAppear 0.3s ease-out forwards;

  &:disabled {
    cursor: not-allowed;
  }

  &:not(:disabled):hover {
    transform: scale(1.25) rotate(10deg);
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  color: var(--rating-color-inactive);

  &--active {
    color: var(--star-color);
  }
}

.rating__icon {
  width: 100%;
  height: 100%;
  color: inherit;
  transition:
    color var(--transition-base),
    transform var(--transition-base);

  :global(svg) {
    width: 100%;
    height: 100%;
    display: block;
    color: inherit;

    path {
      fill: currentColor;
    }
  }
}

// Анимация появления звезды при загрузке
@keyframes starAppear {
  0% {
    opacity: 1;
    transform: scale(0.8) rotate(-20deg);
  }
  70% {
    transform: scale(1.05) rotate(5deg);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
}

// Анимация выбора звезды (при клике)
@keyframes starSelected {
  0% {
    transform: scale(1) rotate(0deg);
  }
  20% {
    transform: scale(1.3) rotate(-10deg);
  }
  40% {
    transform: scale(0.9) rotate(10deg);
  }
  60% {
    transform: scale(1.1) rotate(-5deg);
  }
  80% {
    transform: scale(0.95) rotate(5deg);
  }
  100% {
    transform: scale(1) rotate(0deg);
  }
}
